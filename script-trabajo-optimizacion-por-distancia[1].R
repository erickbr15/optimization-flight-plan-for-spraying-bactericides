#Declaración de la matriz de adyacencia entre parcelas
p0 <- c(0, 340.76949877350734, 10022.123860832955, 4878.926381052754, 3689.769384962011, 10600.163175401916, 6026.953087814776, 8161.584672174851, 8049.763275442355, 1341.0666169944966, 9273.204650571362, 1584.7180441253247, 10251.349144087251, 3557.818600707733, 4867.312856284667, 6877.280504349647, 13036.879496477293, 13270.433706041405, 10207.400293735818, 14431.439800894117, 5731.460115210704, 4555.48430118983, 7518.810753982741, 4126.378824375664, 9806.044991332477, 1614.8986339150326, 11282.733679981708, 11242.23673090607, 3796.9330324558405, 3849.873091111627, 2701.4772855329256, 10576.811849293614, 4308.258315147286, 5928.655523813355, 2777.316236244203, 1348.7730479231634)
p1 <- c(340.76949877350734, 0, 9833.855690365484, 5107.399110866249, 3452.3970165685487, 10531.785999411424, 6274.876521051656, 7879.028185366347, 7783.544295041663, 1665.1711944174383, 9599.284276637745, 1682.273743201831, 10583.831498470017, 3227.3324219387746, 5164.008932820509, 7210.461784276393, 13125.316519774507, 13352.371570537502, 10495.112843409484, 14624.330678430191, 5422.939305874477, 4562.631251554828, 7812.070357812417, 4442.833397484899, 9920.764058586454, 1930.8438645861756, 11307.958745672573, 11277.154250204014, 3496.9588112825295, 3538.5100172486586, 3041.824443125649, 10632.913725112887, 4613.173002610815, 6186.341800099329, 3113.798660894366, 1554.1857132020948)
p2 <- c(10022.123860832955, 9833.855690365484, 0, 9945.739265236985, 11240.310734574292, 3953.536372097333, 15976.889936070558, 3966.6869730304743, 3405.854797814236, 11140.832518398038, 18220.4538771268, 8975.41984562288, 18877.354120817257, 7764.587296903719, 14574.030513056992, 15753.256613512665, 9891.49716872464, 9850.115933425717, 19832.718181902488, 14199.495601754665, 10650.108641628569, 6706.3838624886, 17153.78652432548, 11587.34933848917, 8863.538587588955, 10429.489663780972, 6992.166267411576, 7254.563755864826, 6929.5978829800915, 7095.259545439419, 11858.13041797413, 7553.751626626755, 11370.50995003477, 10950.385033632127, 11464.39762370328, 11369.413919794933)
p3 <- c(4878.926381052754, 5107.399110866249, 9945.739265236985, 0, 8559.198958840563, 8607.232201854535, 8000.612296367551, 10028.328217673383, 9612.571792112336, 4584.372353249486, 8590.123782044715, 3591.6339530128494, 9071.503227397843, 7234.335064269835, 6251.787246722492, 6273.841360794541, 8929.474968299546, 9218.500769680972, 10705.545024365983, 9602.956904889783, 10361.10154021305, 3362.0320486406126, 8270.515565542473, 2206.4757142259436, 5583.880606699552, 3486.129510574211, 7966.872098597926, 7811.133927826249, 6848.753580520226, 7074.814337780402, 3874.951197602699, 6943.623399494161, 1829.1819186667674, 1259.94671165828, 3267.151203883061, 5446.336538476462)
p4 <- c(3689.769384962011, 3452.3970165685487, 11240.310734574292, 8559.198958840563, 0, 12914.21434412629, 7157.539925015344, 8179.912073500316, 8361.79142040559, 4443.583584357144, 11518.438042268059, 5066.884183394488, 12654.805021594617, 3479.199195889523, 6855.149365190203, 9436.73926298038, 16290.228582180656, 16491.14581852337, 11617.681277450176, 18055.11280665451, 2569.051250056093, 7568.585548481229, 9183.154400277477, 7682.184902770621, 13192.820995714306, 5238.1931207725365, 14216.313690982732, 14232.097469739521, 4348.148552323124, 4154.864663216253, 5875.600636439733, 13689.124813120447, 7916.722446837053, 9617.066866198611, 6185.734407473185, 3645.8185897157337)
p5 <- c(10600.163175401916, 10531.785999411424, 3953.536372097333, 8607.232201854535, 12914.21434412629, 0, 15991.38548537694, 7412.61156436169, 6765.806849206271, 11378.904838522147, 17194.820379444904, 9166.026083910287, 17620.92671302444, 9595.228746776223, 14363.740427611034, 14866.706739690931, 5968.53599125721, 5909.086653962882, 19251.315115810503, 10470.740526212154, 13049.899007918491, 6204.031556543963, 16707.15274752059, 10675.358516800015, 5543.6900535622435, 10393.964418527445, 3094.1449107378185, 3382.295049940067, 8689.977146028003, 8938.651611670208, 11617.787793259822, 3867.632853522376, 10355.281300602288, 9257.5689105286, 11090.33309865758, 11883.488240866327)
p6 <- c(6026.953087814776, 6274.876521051656, 15976.889936070558, 8000.612296367551, 7157.539925015344, 15991.38548537694, 0, 14123.4419371386, 14054.159119196858, 4836.283861134495, 4788.240677109837, 7029.126207635331, 6009.288766630387, 9259.857333865299, 1755.976224188487, 3650.779216076746, 16884.739286707314, 17185.438633816466, 4466.487038522837, 16622.073136281913, 9702.691700027714, 9805.51342932895, 2144.9517668313474, 5827.6713794029965, 13553.87433576801, 5641.4429575382255, 15903.310729300694, 15771.152708152962, 9717.428639220487, 9712.071623237882, 4381.001522855466, 14928.70188754638, 6227.401970718139, 8181.169390422368, 4938.359403577136, 4730.16322851654)
p7 <- c(8161.584672174851, 7879.028185366347, 3966.6869730304743, 10028.328217673383, 8179.912073500316, 7412.61156436169, 14123.4419371386, 0, 653.369593712477, 9472.209402135231, 17263.183527955287, 7695.6851001812, 18124.503229569757, 4965.627293732701, 13025.057528935453, 14791.180308916948, 12935.045467672593, 12970.351946750694, 18368.87443277797, 16654.55732312854, 7034.048925547119, 6746.166338904139, 15677.91850539506, 11016.075435108378, 11067.611367997491, 9131.826275913483, 10100.582996067955, 10296.378450502954, 4406.428958084608, 4429.514413567917, 10582.45854763601, 10305.892343972842, 10929.497182495492, 11242.89593850038, 10368.598707692336, 9399.576592390551)
p8 <- c(8049.763275442355, 7783.544295041663, 3405.854797814236, 9612.571792112336, 8361.79142040559, 6765.806849206271, 14054.159119196858, 653.369593712477, 0, 9335.988187586934, 17043.176618786052, 7463.693287313564, 17873.84690149639, 5030.798223169679, 12891.601366442219, 14562.56440464985, 12284.8593888469, 12318.646097001023, 18240.35959473818, 16033.810223474722, 7395.632118294369, 6292.138446728813, 15542.865691901927, 10702.299301862244, 10451.381573514565, 8921.856892478703, 9447.824645592837, 9644.581051977739, 4377.93853871935, 4442.269552997946, 10382.435568425642, 9661.341684858959, 10595.229487462675, 10809.762824249501, 10135.065704595178, 9324.05362753846)
p9 <- c(1341.0666169944966, 1665.1711944174383, 11140.832518398038, 4584.372353249486, 4443.583584357144, 11378.904838522147, 4836.283861134495, 9472.209402135231, 9335.988187586934, 0, 7934.190775539174, 2235.4640476577215, 8922.614059915451, 4892.241209325002, 3556.0422667245157, 5551.260695126634, 13239.81391197926, 13497.82949300552, 8904.567704453408, 14171.550710645972, 6753.507397568324, 5190.535754950605, 6208.49284174219, 3270.9738386000727, 9929.323379579677, 1142.7518625756175, 11739.404400518808, 11663.727196528904, 5130.6955869265175, 5189.747901217162, 1473.3501393620486, 10924.705326215808, 3545.827829041757, 5431.034129323169, 1745.0361718391314, 884.3719762700979)
p10 <- c(9273.204650571362, 9599.284276637745, 18220.4538771268, 8590.123782044715, 11518.438042268059, 17194.820379444904, 4788.240677109837, 17263.183527955287, 17043.176618786052, 7934.190775539174, 0, 9579.546040295796, 1223.3742572529038, 12825.48292580232, 4670.583459661488, 2486.7530474500427, 16372.20456632049, 16709.60204864849, 2820.8520788049814, 14737.86201480319, 14083.818561968275, 11533.981701925683, 2696.394852263208, 6651.577788420164, 13312.745445032842, 8131.357293534261, 16224.17504567014, 16010.419961412432, 13030.038587570907, 13109.442229295131, 6686.550382213262, 15075.305000893548, 6910.851113398385, 8044.4950610996975, 6909.3937478523085, 8308.11096806511)
p11 <- c(1584.7180441253247, 1682.273743201831, 8975.41984562288, 3591.6339530128494, 5066.884183394488, 9166.026083910287, 7029.126207635331, 7695.6851001812, 7463.693287313564, 2235.4640476577215, 9579.546040295796, 0, 10429.189041782147, 3828.167424142714, 5602.0664285179655, 7100.405784045104, 11455.541773138955, 11687.279264652685, 10902.930553512218, 12988.767826642044, 6770.042296495628, 3021.27538735565, 8208.194333653802, 3511.402141241567, 8239.36707989732, 1478.1434536835643, 9713.478777060593, 9666.93671063739, 3681.99318186439, 3843.4559289538424, 2941.026670337164, 8993.524151299447, 3550.332989947262, 4764.820265502188, 2673.839461350861, 2737.1893791075613)
p12 <- c(10251.349144087251, 10583.831498470017, 18877.354120817257, 9071.503227397843, 12654.805021594617, 17620.92671302444, 6009.288766630387, 18124.503229569757, 17873.84690149639, 8922.614059915451, 1223.3742572529038, 10429.189041782147, 0, 13809.042789840098, 5800.154400714133, 3374.743414084496, 16379.285043068467, 16721.841695945717, 3560.4544786824235, 14390.180547037888, 15213.885334115168, 12171.135562701145, 3918.0990876720084, 7296.9751220506705, 13442.03308945288, 9014.907642734126, 16447.324228443693, 16216.09437325042, 13963.255858196339, 14058.157534488726, 7603.658043476466, 15271.731165514233, 7507.749765179503, 8377.365560318156, 7758.748887621897, 9358.144545098454)
p13 <- c(3557.818600707733, 3227.3324219387746, 7764.587296903719, 7234.335064269835, 3479.199195889523, 9595.228746776223, 9259.857333865299, 4965.627293732701, 5030.798223169679, 4892.241209325002, 12825.48292580232, 3828.167424142714, 13809.042789840098, 0, 8334.732293671206, 10434.729132620096, 13567.02723831603, 13725.493123610597, 13613.277416847732, 16027.307984223853, 3645.796410441302, 5036.572219176833, 10959.797585102224, 7308.925083836081, 10736.649457106792, 4936.676864371571, 11223.029339436558, 11284.861550271857, 905.8285953855875, 678.9131493457359, 6234.024290055975, 10869.721132465673, 7374.047127943347, 8472.584358893957, 6209.209235483356, 4610.191413802093)
p14 <- c(4867.312856284667, 5164.008932820509, 14574.030513056992, 6251.787246722492, 6855.149365190203, 14363.740427611034, 1755.976224188487, 13025.057528935453, 12891.601366442219, 3556.0422667245157, 4670.583459661488, 5602.0664285179655, 5800.154400714133, 8334.732293671206, 0, 2706.7732881950633, 15128.768836643392, 15429.618342437128, 5348.763821883973, 14947.330769768196, 9416.88610019548, 8217.80613075766, 2652.9706937996366, 4072.3976633351554, 11798.464244271638, 4146.470475341534, 14175.518500423437, 14037.522273516232, 8660.583278875774, 8698.723089015424, 2764.582796479366, 13187.570671019539, 4471.744673561766, 6431.3924906302445, 3273.506255472241, 3731.5965363095725)
p15 <- c(6877.280504349647, 7210.461784276393, 15753.256613512665, 6273.841360794541, 9436.73926298038, 14866.706739690931, 3650.779216076746, 14791.180308916948, 14562.56440464985, 5551.260695126634, 2486.7530474500427, 7100.405784045104, 3374.743414084496, 10434.729132620096, 2706.7732881950633, 0, 14535.32140819665, 14861.978346807984, 4470.32688110519, 13519.556491419758, 11969.51326696015, 9083.834866935325, 2442.722004288601, 4225.774262420771, 11339.511421972817, 5662.797676238797, 14104.689724396098, 13913.101328031782, 10594.166159598575, 10685.611087675554, 4234.886252510163, 12996.632258486668, 4517.946211214945, 5908.633895797149, 4427.513938235295, 6020.9921814445715)
p16 <- c(13036.879496477293, 13125.316519774507, 9891.49716872464, 8929.474968299546, 16290.228582180656, 5968.53599125721, 16884.739286707314, 12935.045467672593, 12284.8593888469, 13239.81391197926, 16372.20456632049, 11455.541773138955, 16379.285043068467, 13567.02723831603, 15128.768836643392, 14535.32140819665, 0, 347.29090664307165, 18947.428200347167, 4873.116618542267, 17212.627405102572, 8724.803453606728, 16842.149670161023, 11059.07088951827, 3346.3621278327973, 12098.0376925807, 2901.842263446229, 2659.9262576477877, 12748.036580540169, 13029.23006501442, 12785.354302602227, 2727.8215834705625, 10658.266261168154, 8750.385410992843, 12176.555130428109, 14010.437276998371)
p17 <- c(13270.433706041405, 13352.371570537502, 9850.115933425717, 9218.500769680972, 16491.14581852337, 5909.086653962882, 17185.438633816466, 12970.351946750694, 12318.646097001023, 13497.82949300552, 16709.60204864849, 11687.279264652685, 16721.841695945717, 13725.493123610597, 15429.618342437128, 14861.978346807984, 347.29090664307165, 0, 19278.752281620804, 5110.824124381639, 17371.116531262654, 8922.664736823095, 17162.315078261447, 11358.302454580273, 3635.4880820310827, 12357.097305331812, 2887.2570622065227, 2674.1183732171253, 12897.62315982837, 13178.192536517572, 13066.71069864047, 2858.8511127362567, 10958.097261265058, 9063.307859108712, 12458.244000030298, 14260.87221791712)
p18 <- c(10207.400293735818, 10495.112843409484, 19832.718181902488, 10705.545024365983, 11617.681277450176, 19251.315115810503, 4466.487038522837, 18368.87443277797, 18240.35959473818, 8904.567704453408, 2820.8520788049814, 10902.930553512218, 3560.4544786824235, 13613.277416847732, 5348.763821883973, 4470.32688110519, 18947.428200347167, 19278.752281620804, 0, 17529.32659299778, 14150.718116670687, 13294.697077452023, 2700.235944581414, 8576.878382432436, 15791.371412721457, 9427.740466864974, 18574.577132834092, 18383.417118566867, 13989.994718083963, 14014.853744103943, 7979.475292387151, 17466.25310226623, 8907.461159785835, 10378.080575131578, 8374.680262593429, 9009.86598228829)
p19 <- c(14431.439800894117, 14624.330678430191, 14199.495601754665, 9602.956904889783, 18055.11280665451, 10470.740526212154, 16622.073136281913, 16654.55732312854, 16033.810223474722, 14171.550710645972, 14737.86201480319, 12988.767826642044, 14390.180547037888, 16027.307984223853, 14947.330769768196, 13519.556491419758, 4873.116618542267, 5110.824124381639, 17529.32659299778, 0, 19541.824299616714, 11005.877705763238, 15961.860481583253, 11221.153161150109, 5592.103438975215, 13088.476541593069, 7421.754602458774, 7112.353195037524, 15353.697973086582, 15629.400329957869, 13248.849670709284, 6652.856328268289, 10845.136204440747, 8802.55709305922, 12678.427126527022, 15042.771107946483)
p20 <- c(5731.460115210704, 5422.939305874477, 10650.108641628569, 10361.10154021305, 2569.051250056093, 13049.899007918491, 9702.691700027714, 7034.048925547119, 7395.632118294369, 6753.507397568324, 14083.818561968275, 6770.042296495628, 15213.885334115168, 3645.796410441302, 9416.88610019548, 11969.51326696015, 17212.627405102572, 17371.116531262654, 14150.718116670687, 19541.824299616714, 0, 8624.696952052076, 11746.998541570336, 9856.710172782678, 14347.75349039237, 7346.349039105884, 14846.627123359425, 14917.215144725813, 4489.533206975453, 4213.6232840433695, 8224.054200776287, 14514.867646043764, 10036.072696471278, 11523.79125376826, 8446.849175115072, 6048.068909617918)
p21 <- c(4555.48430118983, 4562.631251554828, 6706.3838624886, 3362.0320486406126, 7568.585548481229, 6204.031556543963, 9805.51342932895, 6746.166338904139, 6292.138446728813, 5190.535754950605, 11533.981701925683, 3021.27538735565, 12171.135562701145, 5036.572219176833, 8217.80613075766, 9083.834866935325, 8724.803453606728, 8922.664736823095, 13294.697077452023, 11005.877705763238, 8624.696952052076, 0, 10667.838530550907, 4886.850213686109, 5725.937238434102, 4190.151397272333, 6748.952969531266, 6728.004613093814, 4349.473674767128, 4624.059709667152, 5454.6781140694075, 6130.2502729319185, 4664.170137314824, 4524.074049428907, 4963.819591804994, 5757.9831199734535)
p22 <- c(7518.810753982741, 7812.070357812417, 17153.78652432548, 8270.515565542473, 9183.154400277477, 16707.15274752059, 2144.9517668313474, 15677.91850539506, 15542.865691901927, 6208.49284174219, 2696.394852263208, 8208.194333653802, 3918.0990876720084, 10959.797585102224, 2652.9706937996366, 2442.722004288601, 16842.149670161023, 17162.315078261447, 2700.235944581414, 15961.860481583253, 11746.998541570336, 10667.838530550907, 0, 6083.413482468039, 13590.26075289355, 6735.389797600296, 16223.420916206953, 16053.218690445461, 11308.982808339595, 11341.67407404806, 5295.656508983545, 15159.03978366037, 6443.621700408544, 8119.597577638753, 5716.963868880069, 6349.645733021994)
p23 <- c(4126.378824375664, 4442.833397484899, 11587.34933848917, 2206.4757142259436, 7682.184902770621, 10675.358516800015, 5827.6713794029965, 11016.075435108378, 10702.299301862244, 3270.9738386000727, 6651.577788420164, 3511.402141241567, 7296.9751220506705, 7308.925083836081, 4072.3976633351554, 4225.774262420771, 11059.07088951827, 11358.302454580273, 8576.878382432436, 11221.153161150109, 9856.710172782678, 4886.850213686109, 6083.413482468039, 0, 7726.202967347022, 2512.4292303848283, 10172.536280826793, 10017.584848190889, 7190.609536524828, 7354.827027433717, 2056.635092473943, 9147.351174471361, 402.2726615081554, 2449.0517118015314, 1551.5489954082034, 4139.179216859452)
p24 <- c(9806.044991332477, 9920.764058586454, 8863.538587588955, 5583.880606699552, 13192.820995714306, 5543.6900535622435, 13553.87433576801, 11067.611367997491, 10451.381573514565, 9929.323379579677, 13312.745445032842, 8239.36707989732, 13442.03308945288, 10736.649457106792, 11798.464244271638, 11339.511421972817, 3346.3621278327973, 3635.4880820310827, 15791.371412721457, 5592.103438975215, 14347.75349039237, 5725.937238434102, 13590.26075289355, 7726.202967347022, 0, 8786.577804986198, 3174.92498780301, 2890.348427487346, 9988.64924252596, 10269.681472382956, 9439.810258703463, 1963.2270457062853, 7326.799972673995, 5471.223099645715, 8830.91904696074, 10719.131724555318)
p25 <- c(1614.8986339150326, 1930.8438645861756, 10429.489663780972, 3486.129510574211, 5238.1931207725365, 10393.964418527445, 5641.4429575382255, 9131.826275913483, 8921.856892478703, 1142.7518625756175, 8131.357293534261, 1478.1434536835643, 9014.907642734126, 4936.676864371571, 4146.470475341534, 5662.797676238797, 12098.0376925807, 12357.097305331812, 9427.740466864974, 13088.476541593069, 7346.349039105884, 4190.151397272333, 6735.389797600296, 2512.4292303848283, 8786.577804986198, 0, 10632.59648643927, 10549.337601597643, 4970.007184631789, 5088.677912689446, 1464.672261593272, 9798.145774622273, 2697.7562785062073, 4418.349045555003, 1279.905935164573, 1967.721445682958)
p26 <- c(11282.733679981708, 11307.958745672573, 6992.166267411576, 7966.872098597926, 14216.313690982732, 3094.1449107378185, 15903.310729300694, 10100.582996067955, 9447.824645592837, 11739.404400518808, 16224.17504567014, 9713.478777060593, 16447.324228443693, 11223.029339436558, 14175.518500423437, 14104.689724396098, 2901.842263446229, 2887.2570622065227, 18574.577132834092, 7421.754602458774, 14846.627123359425, 6748.952969531266, 16223.420916206953, 10172.536280826793, 3174.92498780301, 10632.59648643927, 0, 323.99752412146734, 10357.765219364848, 10633.0064873863, 11585.33088437066, 1214.3346482095803, 9794.932855681875, 8205.186185534005, 10995.153401468227, 12413.266799036659)
p27 <- c(11242.23673090607, 11277.154250204014, 7254.563755864826, 7811.133927826249, 14232.097469739521, 3382.295049940067, 15771.152708152962, 10296.378450502954, 9644.581051977739, 11663.727196528904, 16010.419961412432, 9666.93671063739, 16216.09437325042, 11284.861550271857, 14037.522273516232, 13913.101328031782, 2659.9262576477877, 2674.1183732171253, 18383.417118566867, 7112.353195037524, 14917.215144725813, 6728.004613093814, 16053.218690445461, 10017.584848190889, 2890.348427487346, 10549.337601597643, 323.99752412146734, 0, 10427.830613087985, 10704.801681559933, 11470.647576706535, 948.043067659282, 9636.165897779441, 8007.360986018092, 10876.639253353387, 12352.424421906542)
p28 <- c(3796.9330324558405, 3496.9588112825295, 6929.5978829800915, 6848.753580520226, 4348.148552323124, 8689.977146028003, 9717.428639220487, 4406.428958084608, 4377.93853871935, 5130.6955869265175, 13030.038587570907, 3681.99318186439, 13963.255858196339, 905.8285953855875, 8660.583278875774, 10594.166159598575, 12748.036580540169, 12897.62315982837, 13989.994718083963, 15353.697973086582, 4489.533206975453, 4349.473674767128, 11308.982808339595, 7190.609536524828, 9988.64924252596, 4970.007184631789, 10357.765219364848, 10427.830613087985, 0, 282.0842238479744, 6359.901708838599, 10039.115242289858, 7206.488367854443, 8104.875936320206, 6247.924916117449, 4997.5454024551855)
p29 <- c(3849.873091111627, 3538.5100172486586, 7095.259545439419, 7074.814337780402, 4154.864663216253, 8938.651611670208, 9712.071623237882, 4429.514413567917, 4442.269552997946, 5189.747901217162, 13109.442229295131, 3843.4559289538424, 14058.157534488726, 678.9131493457359, 8698.723089015424, 10685.611087675554, 13029.23006501442, 13178.192536517572, 14014.853744103943, 15629.400329957869, 4213.6232840433695, 4624.059709667152, 11341.67407404806, 7354.827027433717, 10269.681472382956, 5088.677912689446, 10633.0064873863, 10704.801681559933, 282.0842238479744, 0, 6455.882886890729, 10319.579947073882, 7383.099870424975, 8328.407703089286, 6368.514816576108, 5008.659959210555)
p30 <- c(2701.4772855329256, 3041.824443125649, 11858.13041797413, 3874.951197602699, 5875.600636439733, 11617.787793259822, 4381.001522855466, 10582.45854763601, 10382.435568425642, 1473.3501393620486, 6686.550382213262, 2941.026670337164, 7603.658043476466, 6234.024290055975, 2764.582796479366, 4234.886252510163, 12785.354302602227, 13066.71069864047, 7979.475292387151, 13248.849670709284, 8224.054200776287, 5454.6781140694075, 5295.656508983545, 2056.635092473943, 9439.810258703463, 1464.672261593272, 11585.33088437066, 11470.647576706535, 6359.901708838599, 6455.882886890729, 0, 10660.701340335083, 2410.6439986960618, 4447.751002662775, 609.0021539220731, 2233.2891019745975)
p31 <- c(10576.811849293614, 10632.913725112887, 7553.751626626755, 6943.623399494161, 13689.124813120447, 3867.632853522376, 14928.70188754638, 10305.892343972842, 9661.341684858959, 10924.705326215808, 15075.305000893548, 8993.524151299447, 15271.731165514233, 10869.721132465673, 13187.570671019539, 12996.632258486668, 2727.8215834705625, 2858.8511127362567, 17466.25310226623, 6652.856328268289, 14514.867646043764, 6130.2502729319185, 15159.03978366037, 9147.351174471361, 1963.2270457062853, 9798.145774622273, 1214.3346482095803, 948.043067659282, 10039.115242289858, 10319.579947073882, 10660.701340335083, 0, 8761.17991137782, 7088.174166573963, 10061.2106981915, 11641.565675597072)
p32 <- c(4308.258315147286, 4613.173002610815, 11370.50995003477, 1829.1819186667674, 7916.722446837053, 10355.281300602288, 6227.401970718139, 10929.497182495492, 10595.229487462675, 3545.827829041757, 6910.851113398385, 3550.332989947262, 7507.749765179503, 7374.047127943347, 4471.744673561766, 4517.946211214945, 10658.266261168154, 10958.097261265058, 8907.461159785835, 10845.136204440747, 10036.072696471278, 4664.170137314824, 6443.621700408544, 402.2726615081554, 7326.799972673995, 2697.7562785062073, 9794.932855681875, 9636.165897779441, 7206.488367854443, 7383.099870424975, 2410.6439986960618, 8761.17991137782, 0, 2058.056731352737, 1870.586865926036, 4424.274041447111)
p33 <- c(5928.655523813355, 6186.341800099329, 10950.385033632127, 1259.94671165828, 9617.066866198611, 9257.5689105286, 8181.169390422368, 11242.89593850038, 10809.762824249501, 5431.034129323169, 8044.4950610996975, 4764.820265502188, 8377.365560318156, 8472.584358893957, 6431.3924906302445, 5908.633895797149, 8750.385410992843, 9063.307859108712, 10378.080575131578, 8802.55709305922, 11523.79125376826, 4524.074049428907, 8119.597577638753, 2449.0517118015314, 5471.223099645715, 4418.349045555003, 8205.186185534005, 8007.360986018092, 8104.875936320206, 8328.407703089286, 4447.751002662775, 7088.174166573963, 2058.056731352737, 0, 3876.373288600264, 6314.084061287098)
p34 <- c(2777.316236244203, 3113.798660894366, 11464.39762370328, 3267.151203883061, 6185.734407473185, 11090.33309865758, 4938.359403577136, 10368.598707692336, 10135.065704595178, 1745.0361718391314, 6909.3937478523085, 2673.839461350861, 7758.748887621897, 6209.209235483356, 3273.506255472241, 4427.513938235295, 12176.555130428109, 12458.244000030298, 8374.680262593429, 12678.427126527022, 8446.849175115072, 4963.819591804994, 5716.963868880069, 1551.5489954082034, 8830.91904696074, 1279.905935164573, 10995.153401468227, 10876.639253353387, 6247.924916117449, 6368.514816576108, 609.0021539220731, 10061.2106981915, 1870.586865926036, 3876.373288600264, 0, 2596.908001821925)
p35 <- c(1348.7730479231634, 1554.1857132020948, 11369.413919794933, 5446.336538476462, 3645.8185897157337, 11883.488240866327, 4730.16322851654, 9399.576592390551, 9324.05362753846, 884.3719762700979, 8308.11096806511, 2737.1893791075613, 9358.144545098454, 4610.191413802093, 3731.5965363095725, 6020.9921814445715, 14010.437276998371, 14260.87221791712, 9009.86598228829, 15042.771107946483, 6048.068909617918, 5757.9831199734535, 6349.645733021994, 4139.179216859452, 10719.131724555318, 1967.721445682958, 12413.266799036659, 12352.424421906542, 4997.5454024551855, 5008.659959210555, 2233.2891019745975, 11641.565675597072, 4424.274041447111, 6314.084061287098, 2596.908001821925, 0)

m_adyacencia <- rbind(
  p0,
  p1,
  p2,
  p3,
  p4,
  p5,
  p6,
  p7,
  p8,
  p9,
  p10,
  p11,
  p12,
  p13,
  p14,
  p15,
  p16,
  p17,
  p18,
  p19,
  p20,
  p21,
  p22,
  p23,
  p24,
  p25,
  p26,
  p27,
  p28,
  p29,
  p30,
  p31,
  p32,
  p33,
  p34,
  p35)

m_adyacencia

n <- length(m_adyacencia[1,])
cromosoma <- c(rep(0,n-10),rep(1,10))
cromosoma

compute.delta.of.jump <- function(working.idx, jump.length){
  
  distancias.working.idx <- m_adyacencia[working.idx,]
  
  min.distance.of.row <- min(distancias.working.idx[distancias.working.idx > 0])
  max.distance.of.row <- max(distancias.working.idx)
  
  mean.distance.of.row <-  min.distance.of.row + ((max.distance.of.row - min.distance.of.row) / 2)
  
  delta <- jump.length / mean.distance.of.row
  
  return (delta)
}

find.the.next.jump <- function(working.cromosoma, working.idx){
  
  cromosoma.distancias <- working.cromosoma * m_adyacencia[working.idx,]
  
  if(!any(cromosoma.distancias > 0)){
    return (list(can.jump <- FALSE, step.0 <- working.idx, step.1 <- working.idx, distance <- 0))
  }
  
  distancia_min <- min(cromosoma.distancias[cromosoma.distancias > 0])
  new.working.idx <- match(distancia_min, cromosoma.distancias)
  
  return (list(can.jump <- TRUE, step.0 <- working.idx, step.1 <- new.working.idx, distance <- distancia_min))
}

compute.path.length <- function(working.cromosoma, result.eval.cromosoma, verbose){
  
  CAN.JUMP.IDX <- 1
  STEP.0.IDX <- 2
  STEP.1.IDX <- 3
  DISTANCE.IDX <- 4
  
  working.idx <- 0
  for(i in 1:length(working.cromosoma)){            
    if(working.cromosoma[i] == 1){
      working.idx <- i
      can.jump <- TRUE
      break
    }
  }
  
  if(working.idx == 0){
    return (result.eval.cromosoma)
  }
  
  next.jump.result <- find.the.next.jump(working.cromosoma, working.idx)    
  can.jump = next.jump.result[[CAN.JUMP.IDX]]
  
  if(can.jump == FALSE){
    if(verbose == TRUE){
      print(paste0(next.jump.result[[STEP.0.IDX]], " ,distance=NULL"))
    }
    return (result.eval.cromosma)
  }    
  
  while(can.jump == TRUE){        
    
    if(verbose == TRUE){
      print(paste0(next.jump.result[[STEP.0.IDX]], " - ", next.jump.result[[STEP.1.IDX]], " ,distance= ", next.jump.result[[DISTANCE.IDX]]))
    }
    
    delta <- compute.delta.of.jump(next.jump.result[[STEP.0.IDX]], next.jump.result[[DISTANCE.IDX]])
    result.eval.cromosoma <- result.eval.cromosoma * delta
    
    working.cromosoma[next.jump.result[[STEP.0.IDX]]] <- 0
    
    next.jump.result <- find.the.next.jump(working.cromosoma, next.jump.result[[STEP.1.IDX]])
    can.jump = next.jump.result[[CAN.JUMP.IDX]]        
  }
  
  if(verbose == TRUE){
    print(paste0(next.jump.result[[STEP.0.IDX]], " - ", next.jump.result[[STEP.1.IDX]], " ,distance= ", next.jump.result[[DISTANCE.IDX]]))
  }
  
  return (result.eval.cromosoma)
}

resultado <- compute.path.length(cromosoma, 1, TRUE)
print(resultado)

